
7-Zip açık kaynaklı bir dosya arşivleyicisidir. Varsayılan olarak 7z biçimli arşiv dosyaları oluşturmaktadır. Ancak çeşitli biçimde arşiv dosyalarını da desteklemektedir (zip, cab, rar, tar, tar.gz, gzip…). 7-Zip’te otomatik güncelleme mekanizması bulunmamaktadır. Bu nedenle kullanıcıların düzenli olarak güncellemeleri takip ederek programı güncel tutmaları gerekmektedir.

![7-Zip Kullanıcı Arayüzü](img/1.png)

**CVE-2025-0411** zafiyeti son zamanlarda keşfedilen ve _Windows’un_ **Mark-of-the-Web (MoTW)** güvenlik mekanizmasını atlatmaya olanak tanıyan bir güvenlik açığıdır. Kullanıcı etkileşimi gerektiren zafiyet arşivlenmiş dosyaların işlenmesi sürecinde ortaya çıkmaktadır.

**Mark-of-the-Web (MoTW),** bir dosyanın internet kaynaklı ve potansiyel tehlikeli olduğunu belirtmek için kullanılan bir _metadata_ işaretidir. _Windows_ _Defender_ _SmartScreen_ bu etiketi taşıyan dosyalar için ek güvenlik kontrolleri uygulamaktadır.

Tarayıcıdan indirilen veya bir e-posta eki olarak indirilen dosyanın yerel kopyasına bir **NTFS** **Alternatif** **Veri** **Akışı** **(Alternate Data Stream – ADS)** ekleyerek **Zone.Identifier** adıyla bir işaretleme yapmaktadır. Bu veri akışında bulunan **ZoneId** değeri **“3”** ise internet kaynaklı olduğunu ifade etmektedir ve bu arşiv dosyasından çıkarılan her dosyaya bu değeri aktarmaktadır.

![İnternetten İndirilmiş Dosyanın Zone.Identifier Bilgisi](/img/2.png)

_Mark-of-the-Web (MotW)_ aktarım özelliği 7-Zip’e 22.0 sürümü ile birlikte gelmektedir. Ancak bu özellik varsayılan olarak etkin değildir. Arşivden çıkarılan dosyalara bu etiketin aktarılması için öncelikle 7-Zip’in kullanıcı arayüzünden veya kayıt defterinden bu özelliğin etkinleştirilmesi gerekmektedir.

![7-Zip Arayüzünden Özelliği Değiştirme](img/3.png)

**CVE-2025-0411** zafiyeti, 7-zip’in 24.09 sürümünden önceki sürümünde iç içe arşivlenmiş dosyalarda içteki arşiv dosyasına **MotW** etiketinin aktarılmaması nedeniyle ortaya çıkmaktadır. Bu durum _Windows_ sistemlerde kötü amaçlı dosyaların fark edilmeden yayılmasına ve zararlı kodların çalıştırılmasına olanak tanımaktadır.


# Tehdit Aktörleri

**CVE-2025-0411** zafiyeti Rusya-Ukrayna savaşında yürütülen siber saldırılarda kullanılmaktadır. Ukrayna’daki devlet kurumları ve özel sektör kuruluşlarını hedef alan siber casusluk kampanyalarında aktif olarak kullanılmaktadır.

Saldırganlar **SmokeLoader** zararlı yazılımını yaymak için bu açıktan faydalanmaktadırlar. İlk erişim sağlamak için _spear_ _phishing_ e-postaları kullanılmaktadır.

![Örnek Oltalama E-Postası](img/4.png)

**Homoglif (homoglyph)** yöntemi kullanarak bu arşiv dosyası içinde yer alan diğer arşiv dosyası Microsoft Word Belgesi olarak gösterilmektedir. Bu sayede saldırganlar tespit edilme olasılığını düşürmektedir.

Birbirlerine benzeyen karakterlere homoglif veya homograf denilmektedir. Homoglif saldırıları da benzer görünümlü karakterler kullanılarak kullanıcıları manipüle eden saldırılardır. Kiril alfabesindeki “а” harfiyle (U+0430) Latin alfabesindeki “a” harfindeki (U+0061) benzerlik bu tür benzerliklere örnektir.

Ukrayna’ya yönelik saldırılarda hedef kullanıcıya gönderilen arşiv dosyasının içerisinde bulunan arşiv dosyasının uzantısı **“doc”** olarak gözükmektedir. Ancak buradaki “c” harfi (U+0063), Kiril alfabesindeki “с” harfidir (U+0441). Bu nedenle _Microsoft_ _Word_ Belgesi olarak gözüken bir arşiv dosyasıdır.

İçeride bulunan manipüle edilmiş ikinci arşiv dosyası bir **“URL”** dosyası içermektedir ve MotW işaretini taşımamaktadır. Bu URL dosyası farklı bir arşiv dosyası (invoce.zip) içeren bir sunucuyu işaret etmektedir.

![URL Dosyasının İşaret Ettiği Sunucudaki Arşiv Dosyası](img/5.png)

Sunucudan elde edilen arşiv dosyası ise PDF görünümlü **SmokeLoader** zararlısını içermektedir. Kullanıcı bu dosyayı çalıştırdığında zararlı aktivitelerini gerçekleştirmektedir.

![PDF Dosyası Görünümlü SmokeLoader Zararlısı](img/6.png)

Böylece 7-Zip’te bulunan CVE-2025-0411 zafiyeti istismar edilmektedir. Bu saldırılarda kullanılan meşru e-posta hesaplarının daha önce ele geçirilmiş hesaplar olduğu düşünülmektedir.

# Proof of Concept – POC

**CVE-2025-0411** zafiyetini istismar etmek amacıyla hesap makinesini (calc.exe) çalıştıran **shell.exe** isimli bir program hazırlanmıştır.

Hazırlanan bu EXE (shell.exe) dosyasına ikili sıkıştırma yapılması gerekmektedir. İçerideki arşiv **in.doс** dışarıdaki arşiv ise **out.7z** olarak isimlendirilmiştir. **in.doс** arşivinin uzantısında yer alan “c” harfi homoglif tekniği kullanılarak Kiril alfabesindeki “с” karakteriyle değiştirilmiştir. Hiyerarşi şu şekildedir:

![](img/figure.png)

**out.7z** arşivine internet kaynaklı bir dosya olduğunu belirten MotW etiketi eklenmektedir. Arşiv dosyasının Özellikler (Properties) kısmında yer alan Güvenlik (Security) kısmı bu dosyanın MotW etiketine sahip olduğunu göstermektedir.

![out.7z Dosyasının MotW Etiketine Sahip Olması](img/7.png)

MotW etiketini kontrol etmek için _PowerShell_ de kullanılabilmektedir. **ZoneId** değerinin **“3”** olması bu dosyanın internet kaynaklı bir dosya olduğunu göstermektedir. Daha sonrasında hedef kullanıcı dosyaları arşivden çıkarmakta ve zararlı dosyayı çalıştırmaktadır.

![Zone.Id Değerinin "3" Olması](img/8.png)

Zafiyetli sürümde bu işlem gerçekleştirildiğinde MotW etiketi arşiv içindeki dosyalara aktarılmamaktadır. **in.doс** arşiv dosyası **DOC** dosyası olarak gözükmekte ve MotW etiketi taşımamaktadır.

![in.doc Dosyasının MotW Etiketini Taşımaması](img/9.png)

Aynı şekilde **Shell.exe** de MotW etiketi taşımamaktadır ve güvenlik mekanizmalarına takılmadan çalıştırılmaktadır.

![shell.exe Dosyasının MotW Etiketini Taşımaması](img/10.png)

Ancak zafiyetin giderildiği sürümde denendiğinde MotW etiketinin içerideki dosyaları aktarıldığı görülmektedir. **Shell.exe** dosyası çalıştırılmak istendiğinde _Microsoft_ _Defender_ _SmartScreen_ tarafından engellenmektedir.

![MotW Etiketini Taşıyan in.doc Dosyası](img/11.png)

![MotW Etiketini Taşıyan shell.exe Dosyası](img/12.png)

![Microsoft Defender SmartScreen Uyarısı](img/13.png)

# Sonuç

CVE-2025-0411, 7-Zip yazılımının arşivden çıkarma işlemlerinde Mark-of-the-Web (MoTW) etiketini içteki dosyalara aktarmaması nedeniyle oluşan bir güvenlik zafiyetidir. Bu durum, saldırganların zararlı içeriği çok katmanlı arşivleme yöntemiyle gizleyerek güvenlik kontrollerini atlatmasına olanak tanımaktadır.

Zafiyet, sosyal mühendislik yöntemleriyle birleştirildiğinde, özellikle e-posta ekleri aracılığıyla kolaylıkla istismar edilebilmektedir. Bu nedenle hem kullanıcı hem de sistem düzeyinde önleyici güvenlik önlemleri alınması kritik önem taşımaktadır.

Bu zafiyete karşı korunmak için öncelikli adım, kullanılan 7-Zip sürümünün güncel olup olmadığını kontrol etmektir. Phishing (oltalama) saldırılarına karşı dikkatli olunmalıdır. Saldırganlar, güvenilir gibi görünen e-posta adreslerinden zararlı ekler göndererek kullanıcıyı kandırmaya çalışmaktadır. Bu nedenle, özellikle bilinmeyen göndericilerden gelen e-postalar dikkatle incelenmeli; ekleri açmadan önce içerik doğrulanmalıdır. E-posta filtreleme sistemleri ve gelişmiş _spam_ korumaları bu noktada etkili bir ilk savunma olmaktadır.

Özellikle ".zip" ya da ".7z" gibi sıkıştırılmış dosyaların içeriği çalıştırılmadan önce analiz edilmeli, gerekiyorsa sanal makine ortamlarında test edilmelidir.

Homoglif (homograph) saldırılarına karşı da proaktif önlemler alınmalıdır. Bu tür saldırılarda, görsel olarak benzer karakterler kullanılarak sahte alan adları oluşturulmaktadır. Kurumsal ağlarda DNS tabanlı alan adı izleme, URL filtreleme ve tehdit istihbaratı entegrasyonu sayesinde bu saldırılar tespit edilip engellenmelidir. Ayrıca, kullanıcılar bu tür alan adları konusunda farkındalık eğitimi almalıdır.

Bunlara ek olarak, işletim sisteminin _Mark-of-the-Web (MoTW)_ etiketlerini doğru şekilde işleyip işlemediği düzenli olarak test edilmelidir. Zararlı içeriğe karşı davranış temelli analiz yapan güvenlik yazılımları ve _sandbox_ çözümleri de kullanılmalıdır.

Son olarak, güvenlik olaylarının erken tespiti için _log_ yönetimi ve tehdit avcılığı (threat hunting) faaliyetleri düzenli olarak yapılmalı, sistemler SIEM (Security Information and Event Management) platformlarıyla izlenmelidir.
